<link rel="stylesheet" href="/css/style.css">   <!-- CSS user -->
<link rel="stylesheet" href="/css/admin.css">   <!-- CSS admin -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<body>

<!-- HEADER ADMIN -->
<header class="admin-header">

    <!-- LEFT: logo + navbar -->
    <div class="admin-left">
        <div class="logo">
            <img src="/images/logo.png">
        </div>

        <nav class="admin-navbar">
            <a href="/admin/dashboard">T·ªïng quan</a>
            <a href="/admin/users">T√†i kho·∫£n</a>
            <a href="/admin/customers">Kh√°ch h√†ng</a>
            <a href="/admin/categories">Th·ªÉ lo·∫°i</a>
            <a href="/admin/books">S√°ch</a>
            <a href="/admin/orders">ƒê∆°n h√†ng</a>
            <a href="/admin/reviews">ƒê√°nh gi√°</a>
            <a href="/admin/revenue">Doanh thu</a>
        </nav>

    </div>

    <!-- RIGHT: user info -->
    <div class="admin-right">
        <span class="welcome">Xin ch√†o, admin</span>
        <a class="logout-btn" th:href="@{/logout}">ƒêƒÉng xu·∫•t</a>
    </div>

</header>


<h1 class="dashboard-title">ADMIN UTE BOOK STORE</h1>

<div class="stats-container">

    <div class="stat-card">
        <div class="stat-icon user"></div>
        <div class="stat-value" th:text="${totalUsers}">0</div>
        <div class="stat-label">T√†i kho·∫£n</div>
    </div>

    <div class="stat-card">
        <div class="stat-icon customer"></div>
        <div class="stat-value" th:text="${totalCustomers}">0</div>
        <div class="stat-label">Kh√°ch h√†ng</div>
    </div>

    <div class="stat-card">
        <div class="stat-icon book"></div>
        <div class="stat-value" th:text="${totalBooks}">0</div>
        <div class="stat-label">S√°ch</div>
    </div>

    <div class="stat-card">
        <div class="stat-icon order"></div>
        <div class="stat-value" th:text="${totalOrders}">0</div>
        <div class="stat-label">ƒê∆°n h√†ng</div>
    </div>

    <div class="stat-card">
        <div class="stat-icon review"></div>
        <div class="stat-value" th:text="${totalReviews}">0</div>
        <div class="stat-label">ƒê√°nh gi√°</div>
    </div>

</div>

<a href="/admin/revenue" style="text-decoration:none; color:inherit;">
    <div class="revenue-chart-highlight">

        <div class="chart-header">
            <span class="chart-icon">üìà</span>
            <h3>Xu h∆∞·ªõng doanh thu 6 th√°ng g·∫ßn nh·∫•t</h3>
        </div>

        <div class="chart-wrapper">
            <canvas id="dashboardRevenueChart"></canvas>
        </div>

    </div>
</a>


<div class="frame-box">
    <h3 class="frame-title">ƒê√£ b√°n g·∫ßn ƒë√¢y</h3>

    <div class="recent-sold-grid">

        <div class="recent-sold-card" th:each="b : ${recentBooks}">

            <div class="sold-img-wrapper">
                <img class="sold-book-img"
                     th:src="@{'/images/books/' + ${b.picture}}"
                     alt="Book Image">
                <span class="sold-badge">ƒê√£ b√°n</span>
            </div>

            <div class="sold-info">
                <div class="sold-title" th:text="${b.title}"></div>
                <div class="sold-author" th:text="${b.author}"></div>

                <div class="sold-price"
                     th:text="${#numbers.formatDecimal(b.price,0,'POINT',0,'COMMA')} + '‚Ç´'"></div>
            </div>

            <a th:href="@{'/admin/books/' + ${b.bookId}}" class="sold-view-btn">
                Xem chi ti·∫øt
            </a>

        </div>

    </div>
</div>


<!-- FOOTER -->
<footer class="admin-footer">
    ¬© 2025 UTE BookStore Admin. All rights reserved.
</footer>


<script th:inline="javascript">
    /*<![CDATA[*/
    let months = /*[[${months}]]*/ [];
    let revenue = /*[[${monthlyRevenue}]]*/ [];
    /*]]>*/
</script>
<script>
    const ctxDash = document.getElementById('dashboardRevenueChart');

    new Chart(ctxDash, {
        type: 'line',
        data: {
            labels: months,
            datasets: [{
                label: 'Doanh thu',
                data: revenue,
                borderColor: '#0B3D2E',
                backgroundColor: 'rgba(11, 61, 46, 0.20)',
                borderWidth: 3,
                tension: 0.35,
                fill: true,
                pointRadius: 5,
                pointBackgroundColor: '#0B3D2E'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                tooltip: {
                    callbacks: {
                        label: ctx => ctx.raw.toLocaleString() + " ‚Ç´"
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: value => value.toLocaleString() + " ‚Ç´"
                    }
                }
            }
        }
    });
</script>

</body>
